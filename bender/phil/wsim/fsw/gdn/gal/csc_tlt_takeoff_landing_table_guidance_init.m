%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Copyright 2010 - 2015 Moon Express, Inc.
% All Rights Reserved.
%
% PROPRIETARY DATA NOTICE:
% The data herein include Proprietary Data and are restricted under the
% Data Rights provisions of Lunar CATALYST Space Act Agreement
% No. SAAM ID# 18251 and Reimbursable Space Act Agreement No.SAA2-402930.
% All information contained herein is and remains proprietary to and the
% property of Moon Express, Inc. Dissemination of this information or
% reproduction of this material is strictly forbidden unless prior
% written permission is obtained from Moon Express, Inc.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FIXME: clean up, update descriptions, rename variables
csu_tbg_table_based_guidance_init;

tlt_altitude_takeoff_table = Simulink.Variant('tlt_altitude_table==1');
tlt_time_takeoff_table = Simulink.Variant('tlt_altitude_table==0');
tlt_altitude_table = 0;


% Velocity command bias to drive errors to zero mean
tlt_terminal_vertical_vel_zero_mean_bias = 0.00; % Set in MOS Proc as well.

% Constant Velocity Command Terminal Guidance Off Vertical Limit Params
tlt_off_vertical_limit = 5.0; % if spurious big pitch angles come in due velocimetry errors limit so errors do not build up
tlt_off_vertical_limit_altitude_enable = 300; % Lower altitude to allow pitchover to initially reduce lateral velocities upon entering

% Vertical component guidance based on full thrust with lateral control
% from table
tlt_quadratic_terminal = 1;

% Altitude to switch back to table guidance
tlt_hdot_control_alt = 30;  

% Efficiency reduction gain due to ACS off pulsing
tlt_accel_avail_gain = 0.30;

%   Alt(m) PosTopoX PosTopoY PosTopoZ VelTopoX VelTopoY VelTopoZ  Kpx  Kpy  Kpz  Kix    Kiy    Kiz   Kdx    Kdy    Kdz
tlt_descent_translate_table_descending = ...
[10000.00    0.000   0.000     0.0      0.0     0.0   -150.0      0.0  0.0  0.0  0.0    0.0    0.0   0.5    0.5   0.10;...
  5000.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  2500.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  2000.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  1900.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  1800.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  1700.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  1600.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  1100.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
  1000.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   900.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   800.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   700.00    0.000   0.000     0.0      0.0     0.0    -40.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   600.00    0.000   0.000     0.0      0.0     0.0    -20.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   500.00    0.000   0.000     0.0      0.0     0.0    -20.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   400.00    0.000   0.000     0.0      0.0     0.0    -20.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   300.00    0.000   0.000     0.0      0.0     0.0    -20.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   200.00    0.000   0.000     0.0      0.0     0.0    -20.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   190.00    0.000   0.000     0.0      0.0     0.0    -19.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   180.00    0.000   0.000     0.0      0.0     0.0    -18.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   170.00    0.000   0.000     0.0      0.0     0.0    -17.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   160.00    0.000   0.000     0.0      0.0     0.0    -16.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   150.00    0.000   0.000     0.0      0.0     0.0    -10.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   140.00    0.000   0.000     0.0      0.0     0.0    -10.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   130.00    0.000   0.000     0.0      0.0     0.0    -10.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   120.00    0.000   0.000     0.0      0.0     0.0    -10.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   110.00    0.000   0.000     0.0      0.0     0.0    -10.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
   100.00    0.000   0.000     0.0      0.0     0.0    -10.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    90.00    0.000   0.000     0.0      0.0     0.0     -9.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    80.00    0.000   0.000     0.0      0.0     0.0     -8.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    70.00    0.000   0.000     0.0      0.0     0.0     -7.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    60.00    0.000   0.000     0.0      0.0     0.0     -6.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    50.00    0.000   0.000     0.0      0.0     0.0     -5.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    40.00    0.000   0.000     0.0      0.0     0.0     -4.0      0.0  0.0  0.0  0.0    0.0    0.0   0.1    0.1   2.00;...
    30.00    0.000   0.000     0.0      0.0     0.0     -3.0      0.0  0.0  0.0  0.0    0.0    0.0   0.5    0.5   5.00;...
    20.00    0.000   0.000     0.0      0.0     0.0     -2.0      0.0  0.0  0.0  0.0    0.0    0.0   0.5    0.5   5.00;...
    10.00    0.000   0.000     0.0      0.0     0.0     -1.0      0.0  0.0  0.0  0.0    0.0    0.0   0.5    0.5   5.00;...
     0.00    0.000   0.000     0.0      0.0     0.0     -1.0      0.0  0.0  0.0  0.0    0.0    0.0   0.5    0.5   5.00;...
    ];

%   Time   PosTopoX PosTopoY PosTopoZ VelTopoX VelTopoY VelTopoZ  Kpx  Kpy  Kpz  Kix    Kiy    Kiz   Kdx    Kdy    Kdz
tlt_takeoff_hover_translate_table =...
    [0.00  -44.1024 -13.8630   0.0      0.0     0.0      0.0      1.0  1.0  1.0  0.0    0.0    0.0   0.0    0.0    0.0;...
     5.00  -44.1024 -13.8630   0.0      0.0     0.0      3.0      0.0  1.0  0.0  0.0    0.0    0.0   1.0    0.1    5.0;...
     8.00  -44.1024 -13.8630  30.0      2.0     0.0      3.0      0.0  0.01 0.0  0.0    0.0    0.0   1.0    0.1    5.0;...
    14.00  -44.1024 -13.8630  30.0      2.0     0.0      0.0      0.0  0.01 0.0  0.0    0.0    0.0   1.0    0.1    5.0;...
    23.00    6.1024 -13.8630  30.0      2.0     0.0      0.0      0.0  0.01 1.0  0.0    0.0    0.0   1.0    0.1    5.0;...
    30.00    6.1024 -13.8630  30.0      2.0     0.0     -3.7      0.0  0.01 0.0  0.0    0.0    0.0   1.0    0.1    1.0;...
    35.00    6.1024 -13.8630  30.0      0.0     0.0     -2.0      0.05 0.01 0.0  0.0    0.0    0.0   1.5    1.5   10.0;...
    39.00    6.1024 -13.8630  30.0      0.0     0.0     -1.0      0.05 0.1  0.0  0.001  0.001  0.0   1.5    1.5   15.0;...
    ];
